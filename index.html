<html>
<head>
</head>
<body>
<script src="processing.js"></script>
<script type="text/processing" data-processing-target="processing-canvas">

final float g = 0.1;
Body bs[];

void setup() {
  size(900, 500, P2D);
  colorMode(HSB, 1);
  background(0);
  fill(0, 0.25);
  cursor(CROSS);
  
  bs = new Body[500];
  for (int i = 0; i < bs.length; i++) {
    bs[i] = new Body(1, new PVector(random(width), random(height)));
  }
}

void draw() {
  noStroke();
  rect(0, 0, width, height);
  
  for (int i = 0; i < bs.length; i++) {
    stroke(0.0002 * i,  0.5, 1);
    Body b = bs[i];
    b.show();
    float r = 100 * sin(frameCount * 0.05);
    float a = sin(frameCount * 0.005) * TWO_PI;
    b.attract(new Body(-1000, new PVector(mouseX + r * cos(a), mouseY + r * sin(a))));
    r = 100 * sin(frameCount * 0.03);
    a = 1 + sin(frameCount * 0.005) * TWO_PI;
    b.attract(new Body(1000, new PVector(mouseX + r * sin(a), mouseY + r * cos(a))));
    r = 100 * sin(frameCount * 0.01);
    a = 2 + sin(frameCount * 0.005) * TWO_PI;
    b.attract(new Body(1000, new PVector(mouseX + r * sin(a), mouseY + r * cos(a))));
    b.update();
  }
}

class Body {
  float m;
  PVector p, q, s;
  
  Body(float m, PVector p) {
    this.m = m;
    this.p = p;
    q = p;
    this.s = new PVector(0, 0);
  }
  
  void update() {
    s.mult(0.98);
    p = PVector.add(p, s);
  }
  
  void attract(Body b) {
    float d = constrain(PVector.dist(p, b.p), 10, 100);
    PVector f = PVector.mult(PVector.sub(b.p, p), b.m * m * g / (d * d));
    PVector a = PVector.div(f, m);
    s.add(a);
  }
  
  void show() {
    line(p.x, p.y, q.x, q.y);
    q = p;
  }
}

</script>
<canvas id="processing-canvas"> </canvas>
</body>
</html>